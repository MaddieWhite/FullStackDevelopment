<!DOCTYPE html>
<html lang="en">

<head>
  <title>Leaderboard</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="BHost template project">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="styles/bootstrap-4.1.2/bootstrap.min.css">
  <link href="plugins/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" type="text/css" href="plugins/OwlCarousel2-2.2.1/owl.carousel.css">
  <link rel="stylesheet" type="text/css" href="plugins/OwlCarousel2-2.2.1/owl.theme.default.css">
  <link rel="stylesheet" type="text/css" href="plugins/OwlCarousel2-2.2.1/animate.css">
  <link href="plugins/video-js/video-js.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" type="text/css" href="styles/about.css">
  <link rel="stylesheet" type="text/css" href="styles/about_responsive.css">

  <script language="javascript">
    function star(icon) {
      $(icon).toggleClass('fa-star-o fa-star');
    }
  </script>

  <style>
    #container {
      width: auto;
      height: auto;
    }

    .row-lg-10 {
      position: 600px;
      display: inline-block;
      width: 100%;
      height: 40px;
      border-bottom: 1px solid #AFAFAF;
    }

    .name {
      position: relative;
      display: inline-block;
      width: 75%;
      line-height: 45px;
    }

    .score {
      position: relative;
      display: inline-block;
      width: 25%;
    }
  </style>

</head>

<body>

  <div class="super_container">

    <!-- Header -->

    <header class="header trans_400">
      <div class="header_content d-flex flex-row align-items-center justify-content-start trans_400">
        <div class="logo"><a href="index.html"><span>sailing</span>Scores</a></div>
        <div class="container">
          <div class="row">
            <div class="col-lg-10 offset-lg-2">
              <nav class="main_nav">
                <ul class="d-flex flex-row align-items-center justify-content-start">
                  <li><a href="index.html">Home</a></li>
                  <li><a href="schools.html">Schools</a></li>
                  <li><a href="leaderboard.html">Leaderboard</a></li>
                  <!--li><a href="blog.html">News</a></li>
								<li><a href="contact.html">Contact</a></li> -->
                </ul>
              </nav>
            </div>
          </div>
        </div>
        <div class="header_right d-flex flex-row align-items-center justify-content-start">

          <!-- Header Links -->
          <div class="header_links">
            <ul class="d-flex flex-row align-items-center justify-content-start">
              <li><a href="login.html">Login</a></li>
            </ul>
          </div>

          <!-- Hamburger -->
          <div class="hamburger"><i class="fa fa-bars" aria-hidden="true"></i></div>
        </div>
      </div>
    </header>

    <!-- Menu -->

    <div class="menu trans_500">
      <div class="menu_content d-flex flex-column align-items-center justify-content-center">
        <div class="menu_nav trans_500">
          <ul class="text-center">
            <li><a href="index.html">Home</a></li>
            <li><a href="schools.html">Schools</a></li>
            <li><a href="leaderboard.html">Leaderboard</a></li>
          </ul>
        </div>
      </div>
    </div>


    <!-- Header -->
    <div class="home">
      <div class="container">
        <div class="row">
          <div class="col">
            <div class="home_content">
              <div class="home_title">Leaderboards</div>
            </div>
          </div>
        </div>
      </div>
    </div>


    <!-- Leaderboard -->
    <div class="container">
      <div class="row">


        <div class="col-md-6">
          <div class="w-95 mt-2">
            <table class="table table-bordered table-hover" id='averagef'>
              <caption>Average Finish</caption>
              <thead class='thead-dark'>
                <tr>
                  <th scope='col'>Rank</th>
                  <th scope='col'>Name</th>
                  <th scope='col'>School</th>
                  <th scope='col'>Average Finish</th>
                </tr>
              </thead>
              <tbody>
                <!-- Rows will populate here -->
              </tbody>
            </table>
          </div>
        </div>

        <div class="col-md-6">
          <div class="w-95 mt-2">
            <table class="table table-bordered table-hover" id="regattas">
              <caption>Regattas Sailed</caption>
              <thead class='thead-dark'>
                <tr>
                  <th scope='col'>Rank</th>
                  <th scope='col'>Name</th>
                  <th scope='col'>School</th>
                  <th scope='col'>Regattas Sailed</th>
                </tr>
              </thead>
              <tbody id="averagefinishbody">
                <!-- Rows will populate here -->
              </tbody>
            </table>
          </div>
        </div>

        <div class="col-md-6">
          <div class="w-95 mt-2">
            <table class="table table-bordered table-hover" id="sailp">
              <caption>Sail Percentage</caption>
              <thead class='thead-dark'>
                <tr>
                  <th scope='col'>Rank</th>
                  <th scope='col'>Name</th>
                  <th scope='col'>School</th>
                  <th scope='col'>Sail Percentage</th>
                </tr>
              </thead>
              <tbody id="averagefinishbody">
                <!-- Rows will populate here -->
              </tbody>
            </table>
          </div>
        </div>


        <div class="col-md-6">
          <div class="w-95 mt-2">
            <table class="table table-bordered table-hover" id='averagef'>
              <caption>Travel Time</caption>
              <thead class='thead-dark'>
                <tr>
                  <th scope='col'>Rank</th>
                  <th scope='col'>Name</th>
                  <th scope='col'>School</th>
                  <th scope='col'>Travel Time</th>
                </tr>
              </thead>
              <tbody>
                <!-- Rows will populate here -->
              </tbody>
            </table>
          </div>
        </div>
              <small class="mb-4 pl-2" >To be included in a leaderboard, you must have gone to ten or more regattas.</small>
      </div>
    </div>

    <script src="js/jquery-3.2.1.min.js"></script>
    <script>
      //Useful function that uppercases the first letter of each word in a word-word-word string.
      function dtu(str) {
        output = "";
        str.match(/([\w\d]+)/g).forEach((element) => {
          output += element.charAt(0).toUpperCase() + element.slice(1) + " ";
        });
        return output;
      }

      function populateTable(column, count, op, columnNum, tableID) {
        $.ajax({
          type: "GET",
          url: "https://teqr5x3h2h.execute-api.us-east-1.amazonaws.com/dev/leaderboard",
          data: {
            column: column,
            count: count,
            op: op
          },
          //If succsessful we parse the data
          success: function(data) {
            for (i = 0; i < data.length; i++) {
              id = data[i][0];
              rank = "#" + (i + 1);
              name = dtu(data[i][0]);
              school = data[i][1];
              if (typeof data[i][columnNum] == "number") {
                stat = data[i][columnNum].toFixed(1);
              } else {
                stat = data[i][columnNum];
              }
              row = '<tr><th scope="row">' + rank + '</th><td><a href="sailor.html?uuid=' + id + '">' + name + '</a></td><td>' + school + '</td><td>' + stat + '</td></tr>';
              $("#" + tableID).append(row);
            }
          },
          error: function(data) {
            console.log(data)
          },
        });
      }

      $(document).ready(function() {
        //Begin our ajax request
        populateTable("sail_percent", 15, "asc", 5, "sailp")
        populateTable("average_finish ", 15, "asc", 2, "averagef")
        populateTable("regatta_count", 15, "desc", 4, "regattas")

      });
    </script>
    <script src="styles/bootstrap-4.1.2/popper.js"></script>
    <script src="styles/bootstrap-4.1.2/bootstrap.min.js"></script>
    <script src="plugins/greensock/TweenMax.min.js"></script>
    <script src="plugins/greensock/TimelineMax.min.js"></script>
    <script src="plugins/scrollmagic/ScrollMagic.min.js"></script>
    <script src="plugins/greensock/animation.gsap.min.js"></script>
    <script src="plugins/greensock/ScrollToPlugin.min.js"></script>
    <script src="plugins/OwlCarousel2-2.2.1/owl.carousel.js"></script>
    <script src="plugins/easing/easing.js"></script>
    <script src="plugins/progressbar/progressbar.min.js"></script>
    <script src="plugins/parallax-js-master/parallax.min.js"></script>
    <script src="js/services.js"></script>
</body>

</html>
